---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import { Icon } from "astro-icon/components";
import FormattedDate from "@/components/FormattedDate.astro";
import TagLink from "@/components/TagLink.astro";

interface Props {
	content: CollectionEntry<"post">;
	readingTime: string;
	updatedDate: Date | null;
}

const {
	content: { data },
	readingTime,
	updatedDate,
} = Astro.props;

const dateTimeOptions: Intl.DateTimeFormatOptions = {
	month: "long",
};
---

{
	data.coverImage && (
		<div class="mb-6 aspect-video">
			<Image alt={data.coverImage.alt} layout="constrained" priority src={data.coverImage.src} />
		</div>
	)
}
{data.draft ? <span class="text-danger text-base">(Draft)</span> : null}
<h1 class="title" id="post-title">{data.title}</h1>
<div class="mt-3 flex flex-wrap items-center gap-x-2 gap-y-1">
	<p class="font-sans font-medium">
		<FormattedDate date={data.publishDate} {dateTimeOptions} /> / {readingTime}
	</p>
	{
		updatedDate && (
			<span class="bg-accent/15 rounded-lg px-2 font-sans font-medium">
				Updated:
				<FormattedDate date={updatedDate} dateTimeOptions={dateTimeOptions} />
			</span>
		)
	}
</div>
{
	!!data.tags?.length && (
		<section class="mt-2" aria-label="Tags">
			<div class="flex items-baseline gap-1">
				<Icon
					aria-hidden="true"
					name="fa7-solid:tags"
					title="Tags"
					class="relative top-1 inline-block h-4 w-4"
				/>
				<ul class="flex flex-wrap">
					{data.tags.map((tag) => (
						<li class="flex items-baseline">
							<TagLink
								class="cactus-link inline-block"
								data-pagefind-filter={`tag:${tag}`}
								href={`/tags/${tag}/`}
								srPrefix="View more blogs with the tag"
								tag={tag}
								showHash={true}
							/>
							{data.tags.at(-1) !== tag && <span aria-hidden="true">,&nbsp;</span>}
						</li>
					))}
				</ul>
			</div>
		</section>
	)
}
