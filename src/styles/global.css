/* would like to ignore ./src/pages/og-image/[slug].png.ts */
@import "tailwindcss";
/* config for tailwindcss-typography plugin */
@config "../../tailwind.config.ts";

/* use a selector-based strategy for dark mode */
@custom-variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

/* you could refactor below to use light-dark(), depending on your target audience */
@theme {
	--color-global-bg: oklch(98.48% 0 0);
	--color-global-text: oklch(26.99% 0.0096 235.05);
	--color-link: oklch(69.44% 0.1812 47.58);
	--color-accent: oklch(69.44% 0.1812 47.58);
	--color-accent-2: oklch(18.15% 0 0);

	--font-sans:
		"Source Sans 3", ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
		"Segoe UI Symbol", "Noto Color Emoji";
	--font-serif: "Source Serif 4", ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
	--font-mono:
		"Source Code Pro", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
		"Courier New", monospace;
}

@layer base {
	html {
		color-scheme: light dark;
		accent-color: var(--color-accent);
		scrollbar-gutter: stable;

		&[data-theme="light"] {
			color-scheme: light;
		}

		&[data-theme="dark"] {
			color-scheme: dark;
			--color-global-bg: oklch(23.64% 0.0045 248);
			--color-global-text: oklch(83.54% 0 264);
			--color-link: oklch(76.62% 0.1369 52.94);
			--color-accent: oklch(76.62% 0.1369 52.94);
			--color-accent-2: oklch(94.66% 0 0);
		}
	}

	/* Tactile feedback for all interactive elements */
	a:active,
	button:active,
	[role="button"]:active {
		@apply bg-link/10;
	}

	:target {
		scroll-margin-block: 5ex;
	}

	@view-transition {
		navigation: auto;
	}

	/* Astro image responsive styles, modified from -> https://docs.astro.build/en/guides/images/#responsive-image-styles */
	:where([data-astro-image]) {
		object-fit: var(--fit);
		object-position: var(--pos);
	}
	[data-astro-image="full-width"] {
		width: 100%;
	}
	[data-astro-image="constrained"] {
		max-width: 100%;
	}
}

@layer components {
	@import "./components/admonition.css";
	@import "./components/github-card.css";

	.cactus-link {
		@apply decoration-link underline underline-offset-2 hover:decoration-2;
	}

	.title {
		@apply text-accent-2 text-3xl font-bold md:text-4xl;
	}

	.anchor-link {
		@apply transition-opacity duration-200;
		margin-left: 0.5rem;
		font-size: 0.75em;
		display: inline-flex;
		align-items: center;
		opacity: 1;
	}

	@media (min-width: 768px) {
		.anchor-link {
			opacity: 0;
		}
	}

	@media (min-width: 768px) {
		.prose :where(h2, h3, h4, h5, h6):hover .anchor-link {
			opacity: 1;
		}
	}

	.anchor-link:focus-visible {
		@apply ring-accent rounded-sm ring-2 outline-none;
		opacity: 1;
	}

	/* fa7-solid:link data url */
	.anchor-icon::before {
		content: "";
		display: inline-block;
		width: 1em;
		height: 1em;
		background-color: currentColor;
		mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1.13em' height='1em' viewBox='0 0 576 512'%3E%3C!-- Icon from Font Awesome Solid by Dave Gandy - https://creativecommons.org/licenses/by/4.0/ --%3E%3Cpath fill='currentColor' d='M419.5 96c-16.6 0-32.7 4.5-46.8 12.7c-15.8-16-34.2-29.4-54.5-39.5c28.2-24 64.1-37.2 101.3-37.2C505.9 32 576 102 576 188.5c0 41.5-16.5 81.3-45.8 110.6l-71.1 71.1C429.8 399.5 390 416 348.5 416C262.1 416 192 346 192 259.5c0-1.5 0-3 .1-4.5c.5-17.7 15.2-31.6 32.9-31.1s31.6 15.2 31.1 32.9v2.6c0 51.1 41.4 92.5 92.5 92.5c24.5 0 48-9.7 65.4-27.1l71.1-71.1c17.3-17.3 27.1-40.9 27.1-65.4c0-51.1-41.4-92.5-92.5-92.5zm-144.3 77.3c-1.9-.8-3.8-1.9-5.5-3.1c-12.6-6.5-27-10.2-42.1-10.2c-24.5 0-48 9.7-65.4 27.1l-71.1 71.1C73.8 275.5 64 299.1 64 323.6c0 51.1 41.4 92.5 92.5 92.5c16.5 0 32.6-4.4 46.7-12.6c15.8 16 34.2 29.4 54.6 39.5c-28.2 23.9-64 37.2-101.3 37.2C70.1 480.2 0 410.2 0 323.7c0-41.5 16.5-81.3 45.8-110.6l71.1-71.1c29.3-29.3 69.1-45.8 110.6-45.8c86.6 0 156.5 70.6 156.5 156.9v3.9c-.4 17.7-15.1 31.6-32.8 31.2s-31.6-15.1-31.2-32.8v-2.3c0-33.7-18-63.3-44.8-79.6z'/%3E%3C/svg%3E");
		mask-size: contain;
		mask-repeat: no-repeat;
		mask-position: center;
	}

	/* fa7-solid:external-link data url */
	.prose :where(a.is-external):not(.not-prose)::after,
	a.has-external-icon.is-external::after {
		content: "";
		display: inline-block;
		width: 0.85em;
		height: 0.85em;
		margin-inline-start: 0.1em;
		background-color: currentColor;
		mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1em' height='1em' viewBox='0 0 640 640'%3E%3C!-- Icon from Font Awesome Solid by Dave Gandy - https://creativecommons.org/licenses/by/4.0/ --%3E%3Cpath fill='currentColor' d='M384 64c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L265.3 329.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L512 173.3V256c0 17.7 14.3 32 32 32s32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-240 96c-44.2 0-80 35.8-80 80v256c0 44.2 35.8 80 80 80h256c44.2 0 80-35.8 80-80v-80c0-17.7-14.3-32-32-32s-32 14.3-32 32v80c0 8.8-7.2 16-16 16H144c-8.8 0-16-7.2-16-16V240c0-8.8 7.2-16 16-16h80c17.7 0 32-14.3 32-32s-14.3-32-32-32z'/%3E%3C/svg%3E");
		mask-size: contain;
		mask-repeat: no-repeat;
		mask-position: center;
		vertical-align: baseline;
		text-decoration: none;
	}

	.prose :where(a.is-external):not(.not-prose):hover::after,
	a.has-external-icon.is-external:hover::after {
		background-color: var(--color-link);
	}
}

@utility prose {
	--tw-prose-body: var(--color-global-text);
	--tw-prose-bold: var(--color-global-text);
	--tw-prose-bullets: var(--color-global-text);
	--tw-prose-captions: color-mix(in oklch, var(--color-global-text) 70%, transparent);
	--tw-prose-code: var(--color-global-text);
	--tw-prose-headings: var(--color-accent-2);
	--tw-prose-hr: 0.5px dashed #666;
	--tw-prose-links: var(--color-global-text);
	--tw-prose-quotes: color-mix(in oklch, var(--color-global-text) 85%, transparent);
	--tw-prose-quote-borders: color-mix(in oklch, var(--color-accent) 85%, transparent);
	--tw-prose-th-borders: #666;
}
